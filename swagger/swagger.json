{
  "openapi": "3.0.0",
  "info": {
    "title": "my-todolist API",
    "version": "1.0.0",
    "description": "PostgreSQL 기반 Todo 관리 RESTful API\n\n이 API는 사용자 인증과 할일 관리를 위한 RESTful API입니다.\n\n- 회원가입 및 로그인을 통한 사용자 인증\n- 할일 생성, 조회, 수정, 삭제 기능\n- 마감일 기반 할일 관리 및 지연 상태 표시\n- JWT 기반 인증 (24시간 유효)\n\nAPI 사용을 위해서는 먼저 회원가입 후 로그인하여 JWT 토큰을 받아야 합니다.",
    "contact": {
      "name": "API Support",
      "email": "support@example.com"
    },
    "license": {
      "name": "MIT License",
      "url": "http://github.com/gruntjs/grunt/blob/master/LICENSE-MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "로컬 개발 서버"
    }
  ],
  "tags": [
    {
      "name": "인증",
      "description": "회원가입 및 로그인 관련 API"
    },
    {
      "name": "할일",
      "description": "할일 관리 관련 API"
    }
  ],
  "paths": {
    "/api/auth/register": {
      "post": {
        "tags": ["인증"],
        "summary": "회원가입",
        "description": "새로운 사용자를 등록합니다",
        "operationId": "register",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["username", "password"],
                "properties": {
                  "username": {
                    "type": "string",
                    "minLength": 4,
                    "maxLength": 20,
                    "pattern": "^[a-zA-Z0-9]+$",
                    "description": "사용자명 (4-20자, 영문/숫자만)",
                    "example": "johndoe"
                  },
                  "password": {
                    "type": "string",
                    "minLength": 8,
                    "description": "비밀번호 (8자 이상)",
                    "example": "password123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "회원가입 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user": {
                          "$ref": "#/components/schemas/User"
                        },
                        "token": {
                          "type": "string",
                          "description": "JWT 인증 토큰 (24시간 유효)",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청 (입력값 검증 실패)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "invalidUsername": {
                    "value": {
                      "success": false,
                      "message": "사용자명은 4-20자의 영문/숫자만 가능합니다"
                    }
                  },
                  "shortPassword": {
                    "value": {
                      "success": false,
                      "message": "비밀번호는 8자 이상이어야 합니다"
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "중복된 사용자명",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "이미 존재하는 사용자명입니다"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": ["인증"],
        "summary": "로그인",
        "description": "사용자 인증 후 JWT 토큰을 발급합니다",
        "operationId": "login",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["username", "password"],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "사용자명",
                    "example": "johndoe"
                  },
                  "password": {
                    "type": "string",
                    "description": "비밀번호",
                    "example": "password123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "로그인 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user": {
                          "$ref": "#/components/schemas/User"
                        },
                        "token": {
                          "type": "string",
                          "description": "JWT 인증 토큰 (24시간 유효)",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "사용자명 또는 비밀번호가 일치하지 않습니다"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/logout": {
      "post": {
        "tags": ["인증"],
        "summary": "로그아웃",
        "description": "사용자 세션을 종료합니다 (JWT 토큰 만료 처리)",
        "operationId": "logout",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "로그아웃 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "로그아웃되었습니다"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "로그인이 필요합니다"
                }
              }
            }
          }
        }
      }
    },
    "/api/todos": {
      "get": {
        "tags": ["할일"],
        "summary": "할일 목록 조회",
        "description": "로그인한 사용자의 모든 할일을 조회합니다 (마감일순 정렬)",
        "operationId": "getTodos",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Todo"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "로그인이 필요합니다"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["할일"],
        "summary": "할일 생성",
        "description": "새로운 할일을 생성합니다",
        "operationId": "createTodo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["title", "dueDate"],
                "properties": {
                  "title": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100,
                    "description": "할일 제목 (1-100자)",
                    "example": "프로젝트 기획서 작성"
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 1000,
                    "description": "할일 상세 설명 (최대 1000자)",
                    "example": "Q1 신규 프로젝트 기획서 초안 작성 및 검토 요청"
                  },
                  "dueDate": {
                    "type": "string",
                    "format": "date",
                    "description": "마감일 (YYYY-MM-DD 형식)",
                    "example": "2026-02-28"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/Todo"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청 (입력값 검증 실패)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "invalidTitle": {
                    "value": {
                      "success": false,
                      "message": "제목은 1-100자로 입력해주세요"
                    }
                  },
                  "invalidDate": {
                    "value": {
                      "success": false,
                      "message": "유효한 마감일을 입력해주세요"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/todos/{id}": {
      "get": {
        "tags": ["할일"],
        "summary": "할일 상세 조회",
        "description": "특정 할일의 상세 정보를 조회합니다",
        "operationId": "getTodoById",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "할일 ID (UUID)",
            "schema": {
              "type": "string",
              "format": "uuid",
              "example": "550e8400-e29b-41d4-a716-446655440000"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/Todo"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "권한 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "권한이 없습니다"
                }
              }
            }
          },
          "404": {
            "description": "리소스 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "할일을 찾을 수 없습니다"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["할일"],
        "summary": "할일 수정",
        "description": "기존 할일의 정보를 수정합니다 (부분 수정 지원)",
        "operationId": "updateTodo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "할일 ID (UUID)",
            "schema": {
              "type": "string",
              "format": "uuid",
              "example": "550e8400-e29b-41d4-a716-446655440000"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100,
                    "description": "할일 제목 (1-100자)",
                    "example": "프로젝트 기획서 수정"
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 1000,
                    "description": "할일 상세 설명 (최대 1000자)",
                    "example": "피드백 반영하여 기획서 수정"
                  },
                  "dueDate": {
                    "type": "string",
                    "format": "date",
                    "description": "마감일 (YYYY-MM-DD 형식)",
                    "example": "2026-03-05"
                  },
                  "done": {
                    "type": "boolean",
                    "description": "완료 여부",
                    "example": false
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/Todo"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청 (입력값 검증 실패)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "권한 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "권한이 없습니다"
                }
              }
            }
          },
          "404": {
            "description": "리소스 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["할일"],
        "summary": "할일 삭제",
        "description": "특정 할일을 영구 삭제합니다",
        "operationId": "deleteTodo",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "할일 ID (UUID)",
            "schema": {
              "type": "string",
              "format": "uuid",
              "example": "550e8400-e29b-41d4-a716-446655440000"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공 (응답 본문 없음)"
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "권한 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "권한이 없습니다"
                }
              }
            }
          },
          "404": {
            "description": "리소스 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "message": "할일을 찾을 수 없습니다"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT 인증 토큰 (유효기간: 24시간)\n\n- 로그인 후 JWT 토큰을 받습니다\n- 모든 인증이 필요한 요청에 대해 Authorization 헤더에 'Bearer {token}' 형식으로 토큰을 포함해야 합니다\n- 토큰이 없거나 유효하지 않은 경우 401 Unauthorized 응답을 받습니다"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "사용자 고유 ID (UUID v4 형식)",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "username": {
            "type": "string",
            "minLength": 4,
            "maxLength": 20,
            "pattern": "^[a-zA-Z0-9]+$",
            "description": "사용자명 (4-20자, 영문/숫자만 허용, 고유)",
            "example": "johndoe"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "계정 생성 일시 (ISO 8601 형식)",
            "example": "2026-02-11T10:30:00Z"
          }
        },
        "required": ["id", "username", "createdAt"]
      },
      "Todo": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "할일 고유 ID (UUID v4 형식)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "userId": {
            "type": "string",
            "format": "uuid",
            "description": "할일 소유자 ID (User.id 외래키)",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "title": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100,
            "description": "할일 제목 (1-100자)",
            "example": "프로젝트 기획서 작성"
          },
          "description": {
            "type": "string",
            "maxLength": 1000,
            "nullable": true,
            "description": "할일 상세 설명 (선택, 최대 1000자)",
            "example": "Q1 신규 프로젝트 기획서 초안 작성 및 검토 요청"
          },
          "dueDate": {
            "type": "string",
            "format": "date",
            "description": "마감일 (YYYY-MM-DD 형식)",
            "example": "2026-02-28"
          },
          "done": {
            "type": "boolean",
            "description": "완료 여부 (기본값: false)",
            "default": false,
            "example": false
          },
          "isOverdue": {
            "type": "boolean",
            "description": "마감일 초과 여부 (자동 계산: dueDate < 오늘 && done === false)\n\n- 마감일이 지났고, 완료되지 않은 할일에 대해 true\n- 시간은 고려하지 않고 날짜만 비교 (00:00:00 기준)\n- 완료된 할일(done=true)은 isOverdue가 false regardless of dueDate",
            "example": false
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "할일 생성 일시 (ISO 8601 형식)",
            "example": "2026-02-11T10:30:00Z"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "description": "할일 수정 일시 (ISO 8601 형식, 자동 갱신)",
            "example": "2026-02-11T15:45:00Z"
          }
        },
        "required": ["id", "userId", "title", "dueDate", "done", "isOverdue", "createdAt", "updatedAt"]
      },
      "Error": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false,
            "description": "요청 성공 여부"
          },
          "message": {
            "type": "string",
            "description": "에러 메시지 (한국어)",
            "example": "에러가 발생했습니다"
          }
        },
        "required": ["success", "message"]
      }
    }
  }
}