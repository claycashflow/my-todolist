# 도메인 정의서

**버전**: 1.2
**최종 수정일**: 2026-02-11
**작성자**: 비즈니스 분석팀
**데이터베이스**: PostgreSQL 17

## 1. 프로젝트 개요

### 1.1 프로젝트 배경
개인 일정을 효율적으로 관리할 수 있는 도구의 부재로 인한 생산성 저하 문제를 해결하기 위한 웹 기반 일정관리 애플리케이션 개발

### 1.2 목표
- 인증된 사용자에게 개인 할 일 관리 기능 제공
- 마감일 기반의 효율적인 일정 관리 지원
- 브라우저 환경에서 언제 어디서나 접근 가능한 서비스 제공

### 1.3 범위
- 회원 가입 및 인증 기능
- 개인 할 일(Todo) CRUD 기능
- 마감일 관리 및 시각적 알림
- 완료 상태 관리

---

## 2. 비즈니스 도메인 정의

### 2.1 핵심 도메인
**일정관리 (Todo Management)**
- 사용자가 자신의 할 일을 생성하고 관리하는 핵심 업무 영역
- 마감일 기반으로 우선순위를 파악하고 작업을 완료 처리하는 프로세스

### 2.2 지원 도메인
**사용자 인증 (User Authentication)**
- 회원 가입 및 로그인을 통한 사용자 식별
- 개인 데이터 보호 및 접근 제어

---

## 3. 핵심 엔티티 및 속성

### 3.1 사용자 (User)
| 속성 | 타입 | 필수 | 설명 | 제약조건 |
|------|------|------|------|---------|
| id | String | O | 사용자 고유 식별자 | UUID v4 |
| username | String | O | 로그인 아이디 (unique) | 4~20자, 영문/숫자 조합 |
| password | String | O | 암호화된 비밀번호 | 최소 8자 이상 (해시 저장) |
| createdAt | DateTime | O | 가입 일시 | ISO 8601 형식 |

### 3.2 할일 (Todo)
| 속성 | 타입 | 필수 | 설명 | 제약조건 |
|------|------|------|------|---------|
| id | String | O | 할 일 고유 식별자 | UUID v4 |
| userId | String | O | 소유자 (User 참조) | User.id 외래키 |
| title | String | O | 할 일 제목 | 1~100자 |
| description | String | X | 할 일 상세 설명 | 최대 1000자 |
| dueDate | Date | O | 마감 날짜 | YYYY-MM-DD 형식 |
| done | Boolean | O | 완료 여부 (기본값: false) | true/false |
| createdAt | DateTime | O | 생성 일시 | ISO 8601 형식 |
| updatedAt | DateTime | O | 수정 일시 | ISO 8601 형식 |

---

## 4. 주요 비즈니스 규칙

### 4.1 인증 및 권한
- **BR-001**: 회원 가입은 누구나 할 수 있으며, username은 중복될 수 없다
  - 검증: username 4~20자, 영문/숫자만 허용, DB에 동일 username 존재 시 409 에러
  - 검증: password 최소 8자 이상, 저장 시 bcrypt 해시화
  - 구현: `POST /auth/register`

- **BR-002**: 로그인 시 username과 password가 일치해야 세션이 생성된다
  - 검증: DB에서 username 조회 후 password 해시 비교
  - 성공: JWT 토큰 발급 (유효기간 24시간)
  - 실패: 401 Unauthorized, "아이디 또는 비밀번호가 일치하지 않습니다"
  - 구현: `POST /auth/login`

- **BR-003**: 할 일 생성, 조회, 수정, 삭제는 인증된 사용자만 가능하다
  - 검증: Authorization 헤더의 JWT 토큰 유효성 확인
  - 실패: 401 Unauthorized, "로그인이 필요합니다"
  - 구현: `authMiddleware` (모든 /todos/* 경로에 적용)

- **BR-004**: 사용자는 자신이 생성한 할 일만 조회 및 수정할 수 있다
  - 검증: Todo.userId === JWT payload.userId
  - 실패: 403 Forbidden, "권한이 없습니다"
  - 구현: `ownershipMiddleware`

### 4.2 할일 관리
- **BR-005**: 할 일 생성 시 제목(title)과 마감일(dueDate)은 필수 입력값이다
  - 검증: title이 null, undefined, 빈 문자열("") 또는 공백만 있으면 400 에러
  - 검증: title 길이가 1~100자 범위를 벗어나면 400 에러
  - 검증: dueDate가 유효한 날짜 형식(YYYY-MM-DD)이 아니면 400 에러
  - 에러 메시지: "제목은 1~100자로 입력해주세요", "유효한 마감일을 입력해주세요"
  - 구현: `POST /todos`

- **BR-006**: 마감일이 현재 날짜보다 이전인 할 일은 "지연됨" 상태로 표시한다
  - 계산식: `isOverdue = (dueDate < today) && (done === false)`
  - 날짜 비교: 시간 제외, 날짜만 비교 (00:00:00 기준)
  - 마감일이 오늘인 경우: 지연되지 않은 것으로 간주
  - UI 표시: isOverdue=true인 할일은 빨간색 배경(#ffebee), 경고 아이콘 표시
  - 구현: `GET /todos` 응답에 `isOverdue` 필드 포함

- **BR-007**: 완료 처리된 할 일(done=true)은 지연 여부와 관계없이 완료 상태로 표시한다
  - UI 표시: 취소선, 회색 텍스트, 체크 아이콘
  - 완료된 할일은 BR-006의 지연 스타일 적용 안 함
  - 구현: 프론트엔드 스타일 조건부 적용

- **BR-008**: 할 일 수정 시 제목, 설명, 마감일, 완료 여부를 변경할 수 있다
  - 검증: 수정하는 필드에 대해 BR-005와 동일한 검증 적용
  - 부분 수정 허용: 변경할 필드만 전송 가능
  - 구현: `PUT /todos/:id` 또는 `PATCH /todos/:id`

- **BR-009**: 할 일 삭제 시 복구할 수 없으며 영구 삭제된다
  - UI 확인: 삭제 전 "정말 삭제하시겠습니까?" 확인 대화상자 표시
  - 성공: 204 No Content (응답 본문 없음)
  - 구현: `DELETE /todos/:id`

### 4.3 데이터 무결성
- **BR-010**: 사용자 삭제 기능은 제공하지 않는다
  - 사용자 계정 관리는 향후 관리자 기능으로 별도 구현 예정
  - 대안: 계정 비활성화 기능 고려

- **BR-011**: 할 일은 반드시 하나의 사용자에게 귀속되어야 한다
  - 검증: Todo 생성 시 userId는 필수이며, 존재하는 User.id여야 함
  - 외래키 제약: DB 레벨에서 참조 무결성 보장
  - 구현: 데이터베이스 스키마 설계 시 반영

---

## 5. 사용자 시나리오

### 5.1 회원 가입 및 로그인
```
Given: 서비스 접속
When: 회원 가입 페이지에서 username "newuser", password "password123" 입력 후 가입
Then:
  - HTTP 201 Created 응답
  - 계정이 DB에 생성됨 (password는 해시화되어 저장)
  - 로그인 페이지로 리다이렉트
  - 검증 규칙: BR-001

Given: 가입된 계정 정보
When: 로그인 페이지에서 username과 password 입력
Then:
  - HTTP 200 OK 응답
  - JWT 토큰 발급 (응답 본문 또는 쿠키)
  - 할 일 목록 페이지로 이동
  - 검증 규칙: BR-002
```

### 5.2 할일 등록
```
Given: 로그인된 사용자 (JWT 토큰 보유)
When: 할 일 추가 버튼 클릭 후 제목 "보고서 작성", 설명 "분기 실적 보고서", 마감일 "2026-02-15" 입력
Then:
  - HTTP 201 Created 응답
  - 응답 본문에 생성된 할일 객체 포함 (id, userId, title, description, dueDate, done=false)
  - 할일 목록 페이지에 새 항목이 즉시 표시됨
  - 검증 규칙: BR-003, BR-005
```

### 5.3 할일 조회 및 상태 확인
```
Given: 등록된 할 일이 존재
When: 할 일 목록 페이지 접속
Then:
  - HTTP 200 OK 응답
  - 본인의 할 일 목록이 배열로 반환됨 (각 항목에 isOverdue 필드 포함)
  - UI 표시:
    * 마감일 지난 미완료 할일: 빨간색 배경(#ffebee) + 경고 아이콘
    * 완료된 할일: 취소선 + 회색 텍스트 + 체크 아이콘
    * 일반 할일: 기본 스타일
  - 검증 규칙: BR-003, BR-006, BR-007
```

### 5.4 할일 완료 처리
```
Given: 미완료 상태(done=false)의 할 일
When: 할 일 항목의 완료 체크박스 클릭
Then:
  - HTTP 200 OK 응답
  - done 필드가 true로 변경됨
  - UI에서 취소선 + 회색 텍스트 + 체크 아이콘 표시
  - 지연 상태였어도 지연 스타일 제거됨
  - 검증 규칙: BR-003, BR-004, BR-007
```

### 5.5 할일 수정
```
Given: 기존 할 일 선택 (본인 소유)
When: 수정 버튼 클릭 후 제목을 "보고서 완성"으로, 마감일을 "2026-02-20"으로 변경
Then:
  - HTTP 200 OK 응답
  - 응답 본문에 수정된 할일 객체 포함
  - 목록에서 즉시 변경사항 반영
  - updatedAt 타임스탬프 갱신
  - 검증 규칙: BR-003, BR-004, BR-008
```

### 5.6 할일 삭제
```
Given: 기존 할 일 선택 (본인 소유)
When: 삭제 버튼 클릭 후 "정말 삭제하시겠습니까?" 확인
Then:
  - HTTP 204 No Content 응답
  - DB에서 영구 삭제 (복구 불가)
  - 목록에서 즉시 제거됨
  - 검증 규칙: BR-003, BR-004, BR-009
```

### 5.7 마감일 지연 알림
```
Given: 마감일이 2026-02-09인 미완료 할 일 (done=false)
When: 현재 날짜가 2026-02-10 이후
Then:
  - GET /todos 응답에서 해당 할일의 isOverdue=true
  - UI에서 빨간색 배경(#ffebee) + 경고 아이콘으로 표시
  - 완료 처리하면 즉시 일반 스타일로 변경
  - 검증 규칙: BR-006
```

### 5.8 예외: 중복 사용자 가입
```
Given: 이미 존재하는 username "testuser"
When: 동일한 username "testuser"로 회원 가입 시도
Then:
  - HTTP 409 Conflict 응답
  - 에러 메시지: "이미 사용 중인 아이디입니다"
  - 가입 폼 유지 (다른 username 입력 가능)
  - 검증 규칙: BR-001
```

### 5.9 예외: 잘못된 로그인 정보
```
Given: 존재하지 않는 username 또는 잘못된 password
When: 로그인 페이지에서 username "wronguser", password "wrongpass" 입력
Then:
  - HTTP 401 Unauthorized 응답
  - 에러 메시지: "아이디 또는 비밀번호가 일치하지 않습니다"
  - 로그인 폼 유지
  - 검증 규칙: BR-002
```

### 5.10 예외: 필수 입력값 누락
```
Given: 로그인된 사용자
When: 제목(title) 없이 할일 생성 시도 (빈 문자열 또는 공백만)
Then:
  - HTTP 400 Bad Request 응답
  - 에러 메시지: "제목은 1~100자로 입력해주세요"
  - 입력 폼 유지 (다시 입력 가능)
  - 검증 규칙: BR-005
```

### 5.11 예외: 권한 없는 할일 접근
```
Given: 사용자 A로 로그인
When: 사용자 B가 작성한 할일을 수정 또는 삭제 시도
Then:
  - HTTP 403 Forbidden 응답
  - 에러 메시지: "권한이 없습니다"
  - 목록 페이지로 리다이렉트
  - 검증 규칙: BR-004
```

---

## 부록 A: 용어 정의

| 용어 | 정의 |
|------|------|
| 할일 (Todo) | 사용자가 완료해야 하는 작업 항목 |
| 마감일 (Due Date) | 할 일을 완료해야 하는 기한 |
| 완료 여부 (Done) | 할 일의 완료 상태를 나타내는 불린 값 |
| 지연됨 (Overdue) | 마감일이 지났으나 완료되지 않은 상태 |
| 인증 (Authentication) | 사용자 신원을 확인하는 프로세스 |
| JWT (JSON Web Token) | 사용자 인증 정보를 담은 토큰 |

---

## 부록 B: 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-02-10 | 최초 작성 (프로젝트 개요, 엔티티, 비즈니스 규칙, 시나리오) | 비즈니스 분석팀 |
| 1.1 | 2026-02-10 | 품질 평가 결과 반영: 검증 기준 구체화, 예외 시나리오 추가(5.8~5.11), 구현 위치 태그 추가, 엔티티 제약조건 명시 | 비즈니스 분석팀 |

---

## 부록 C: 다음 단계

이 도메인 정의서를 바탕으로 다음 문서를 작성할 예정:
- `2-api-specification.md` - REST API 엔드포인트 상세 명세
- `3-database-schema.md` - 데이터베이스 스키마 설계
- `4-ui-wireframe.md` - 화면 설계 및 와이어프레임
